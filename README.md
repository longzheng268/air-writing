# éš”ç©ºä¹¦å†™ - Air Writing

[English](#english) | [ä¸­æ–‡](#chinese)

---

<a name="chinese"></a>

## ğŸ“– é¡¹ç›®ç®€ä»‹

ä¸€ä¸ªåŸºäºæ‰‹åŠ¿è¯†åˆ«çš„éš”ç©ºä¹¦å†™Webåº”ç”¨ï¼Œä½¿ç”¨ MediaPipe Hands æŠ€æœ¯å®ç°å®æ—¶æ‰‹éƒ¨è¿½è¸ªå’Œç»˜å›¾åŠŸèƒ½ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æ‘„åƒå¤´æ•æ‰æ‰‹éƒ¨åŠ¨ä½œï¼Œåœ¨ç©ºä¸­ä¹¦å†™å’Œç»˜ç”»ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ–ï¸ **å®æ—¶æ‰‹åŠ¿è¯†åˆ«** - ä½¿ç”¨ MediaPipe Hands è¿›è¡Œç²¾å‡†çš„æ‰‹éƒ¨è¿½è¸ª
- âœï¸ **éš”ç©ºä¹¦å†™** - é€šè¿‡æåˆæ‰‹åŠ¿åœ¨ç©ºä¸­ä¹¦å†™å’Œç»˜ç”»
- ğŸ¨ **è‡ªå®šä¹‰ç”»ç¬”** - æ”¯æŒå¤šç§é¢œè‰²å’Œç”»ç¬”å¤§å°è°ƒèŠ‚
- âœ¨ **å¹³æ»‘ç»˜å›¾** - é‡‡ç”¨è´å¡å°”æ›²çº¿å’ŒæŒ‡æ•°ç§»åŠ¨å¹³å‡ç®—æ³•ï¼Œæ¶ˆé™¤æŠ–åŠ¨
- ğŸ’¾ **ä¿å­˜ä½œå“** - ä¸€é”®ä¿å­˜ä½ çš„åˆ›ä½œä¸º PNG å›¾ç‰‡
- ğŸŒ **é™æ€éƒ¨ç½²** - çº¯å‰ç«¯å®ç°ï¼Œå®Œç¾å…¼å®¹ Cloudflare Pages
- ğŸŒ **åŒè¯­æ”¯æŒ** - ä¸­è‹±æ–‡ç•Œé¢åˆ‡æ¢
- ğŸ“± **å“åº”å¼è®¾è®¡** - é€‚é…å„ç§å±å¹•å°ºå¯¸
- ğŸ­ **ç°ä»£UI** - é‡‡ç”¨ç»ç’ƒæ€è®¾è®¡å’Œæµç•…åŠ¨ç”»
- ğŸ—ï¸ **æ¨¡å—åŒ–æ¶æ„** - æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: å…‹éš†é¡¹ç›®

```bash
git clone <your-repo-url>
cd air-writing
```

### æ­¥éª¤ 2: å®‰è£…ä¾èµ–

```bash
npm install
```

### æ­¥éª¤ 3: å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨

```bash
npm run dev
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:8000`

### æ­¥éª¤ 4: æˆæƒæ‘„åƒå¤´

é¦–æ¬¡è®¿é—®æ—¶ï¼Œæµè§ˆå™¨ä¼šè¯·æ±‚æ‘„åƒå¤´æƒé™ï¼Œç‚¹å‡»"å…è®¸"ã€‚

### æ­¥éª¤ 5: å¼€å§‹ä¹¦å†™

1. å°†æ‰‹ä¼¸åˆ°æ‘„åƒå¤´å‰
2. é£ŸæŒ‡å’Œæ‹‡æŒ‡é è¿‘ï¼ˆæåˆï¼‰å¼€å§‹ç»˜åˆ¶
3. ç§»åŠ¨æ‰‹æŒ‡è¿›è¡Œä¹¦å†™
4. åˆ†å¼€æ‰‹æŒ‡åœæ­¢ç»˜åˆ¶

## ğŸ® ä½¿ç”¨æ–¹æ³•

### æ‰‹åŠ¿æ§åˆ¶

- **å¼€å§‹ç»˜åˆ¶** - å°†é£ŸæŒ‡å’Œæ‹‡æŒ‡é è¿‘ï¼ˆæåˆæ‰‹åŠ¿ï¼‰
- **åœæ­¢ç»˜åˆ¶** - å°†æ‰‹æŒ‡åˆ†å¼€
- **ç§»åŠ¨å…‰æ ‡** - ç§»åŠ¨é£ŸæŒ‡æ¥æ§åˆ¶ç»˜å›¾ä½ç½®

### ç”»ç¬”è®¾ç½®

- è°ƒæ•´ç”»ç¬”å¤§å°æ»‘å—æ¥æ”¹å˜çº¿æ¡ç²—ç»†
- ç‚¹å‡»é¢œè‰²æŒ‰é’®é€‰æ‹©ä¸åŒçš„ç”»ç¬”é¢œè‰²
- ä½¿ç”¨"æ¸…ç©ºç”»å¸ƒ"æŒ‰é’®æ¸…é™¤æ‰€æœ‰å†…å®¹
- ä½¿ç”¨"ä¿å­˜å›¾ç‰‡"æŒ‰é’®ä¸‹è½½ä½ çš„ä½œå“

### è¯­è¨€åˆ‡æ¢

ç‚¹å‡»å³ä¸Šè§’çš„è¯­è¨€åˆ‡æ¢æŒ‰é’®åœ¨ä¸­è‹±æ–‡ä¹‹é—´åˆ‡æ¢ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
air-writing/
â”œâ”€â”€ assets/                 # èµ„æºç›®å½•
â”‚   â”œâ”€â”€ css/               # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ style.css      # ä¸»æ ·å¼è¡¨
â”‚   â”œâ”€â”€ js/                # JavaScript æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ app.js         # ä¸»åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.js      # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ i18n.js        # å›½é™…åŒ–æ”¯æŒ
â”‚   â”‚   â”œâ”€â”€ canvas-renderer.js    # Canvas æ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ gesture-detector.js   # æ‰‹åŠ¿æ£€æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ mediapipe-manager.js  # MediaPipe ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ ui-controller.js      # UI æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ drawing-smoothing.js  # ç»˜å›¾å¹³æ»‘
â”‚   â””â”€â”€ images/            # å›¾ç‰‡èµ„æº
â”œâ”€â”€ index.html             # ä¸» HTML æ–‡ä»¶
â”œâ”€â”€ package.json           # NPM é…ç½®
â”œâ”€â”€ wrangler.toml          # Cloudflare é…ç½®
â”œâ”€â”€ .gitignore             # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

## ğŸ—ï¸ æ¨¡å—åŒ–æ¶æ„

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå„æ¨¡å—èŒè´£æ¸…æ™°ï¼š

### æ ¸å¿ƒæ¨¡å—

- **config.js** - é›†ä¸­ç®¡ç†æ‰€æœ‰é…ç½®å‚æ•°
- **i18n.js** - å›½é™…åŒ–å’Œè¯­è¨€åˆ‡æ¢
- **canvas-renderer.js** - è´Ÿè´£æ‰€æœ‰ Canvas ç»˜å›¾æ“ä½œ
- **gesture-detector.js** - æ‰‹åŠ¿è¯†åˆ«å’Œæ£€æµ‹é€»è¾‘
- **mediapipe-manager.js** - MediaPipe å¼•æ“ç®¡ç†
- **ui-controller.js** - ç”¨æˆ·ç•Œé¢äº¤äº’æ§åˆ¶
- **drawing-smoothing.js** - ç»˜å›¾å¹³æ»‘ç®—æ³•
- **app.js** - ä¸»åº”ç”¨ç¨‹åºï¼Œæ•´åˆæ‰€æœ‰æ¨¡å—

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **HTML5** - é¡µé¢ç»“æ„
- **CSS3** - æ ·å¼å’ŒåŠ¨ç”»
- **JavaScript (ES6+)** - åº”ç”¨é€»è¾‘
- **MediaPipe Hands** - æ‰‹åŠ¿è¯†åˆ«
- **Canvas API** - ç»˜å›¾åŠŸèƒ½
- **Cloudflare Pages** - è¾¹ç¼˜éƒ¨ç½²

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½å®ç°

### æ‰‹åŠ¿è¯†åˆ«

ä½¿ç”¨ MediaPipe Hands åº“è¿›è¡Œå®æ—¶æ‰‹éƒ¨å…³é”®ç‚¹æ£€æµ‹ï¼Œé€šè¿‡è®¡ç®—æ‹‡æŒ‡å’Œé£ŸæŒ‡å°–ç«¯çš„è·ç¦»æ¥åˆ¤æ–­æ˜¯å¦æ‰§è¡Œæåˆæ‰‹åŠ¿ã€‚

```javascript
const distance = Math.sqrt(
    Math.pow(thumbTip.x - indexTip.x, 2) +
    Math.pow(thumbTip.y - indexTip.y, 2) +
    Math.pow(thumbTip.z - indexTip.z, 2)
);
return distance < pinchThreshold;
```

### å¹³æ»‘ç»˜å›¾ç³»ç»Ÿ

ä¸ºäº†æ¶ˆé™¤æ‰‹éƒ¨æŠ–åŠ¨å¸¦æ¥çš„å­—è¿¹ä¸ç¨³å®šé—®é¢˜ï¼Œå®ç°äº†åŒé‡å¹³æ»‘æœºåˆ¶ï¼š

1. **æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼ˆEMAï¼‰** - å¯¹æ‰‹éƒ¨ä½ç½®è¿›è¡Œæ—¶é—´åºåˆ—å¹³æ»‘
2. **è´å¡å°”æ›²çº¿æ’å€¼** - ä½¿ç”¨äºŒæ¬¡è´å¡å°”æ›²çº¿è¿æ¥ç‚¹ï¼Œä½¿çº¿æ¡æ›´åŠ æµç•…

```javascript
// æŒ‡æ•°ç§»åŠ¨å¹³å‡
const weight = Math.pow(smoothingFactor, points.length - 1 - i);
smoothedX += points[i].x * weight;

// è´å¡å°”æ›²çº¿æ’å€¼
const cpx = (x1 + x2) / 2;
const cpy = (y1 + y2) / 2;
ctx.quadraticCurveTo(x1, y1, cpx, cpy);
```

è¿™ä¸¤ç§æŠ€æœ¯ç»“åˆä½¿ç”¨ï¼Œæ˜¾è‘—æå‡äº†ä¹¦å†™ä½“éªŒã€‚

### å›½é™…åŒ–æ”¯æŒ

å®ç°äº†å®Œæ•´çš„ä¸­è‹±æ–‡åŒè¯­æ”¯æŒï¼š

- åŠ¨æ€è¯­è¨€åˆ‡æ¢
- æœ¬åœ°å­˜å‚¨è¯­è¨€åå¥½
- æ‰€æœ‰UIæ–‡æœ¬æ”¯æŒç¿»è¯‘
- å¹³æ»‘çš„åˆ‡æ¢åŠ¨ç”»

## â˜ï¸ Cloudflare Pages éƒ¨ç½²

æœ¬é¡¹ç›®æ˜¯çº¯é™æ€ç½‘ç«™ï¼Œæ”¯æŒé€šè¿‡ Git é›†æˆè‡ªåŠ¨éƒ¨ç½²åˆ° Cloudflare Pagesã€‚

### æ–¹å¼ä¸€ï¼šGit é›†æˆï¼ˆæ¨è - è‡ªåŠ¨éƒ¨ç½²ï¼‰

1. **æ¨é€ä»£ç åˆ° Git ä»“åº“**
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

2. **ç™»å½• Cloudflare Dashboard**
   - è®¿é—® https://dash.cloudflare.com/
   - è¿›å…¥ **Pages** éƒ¨åˆ†

3. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» **Create a project**
   - é€‰æ‹© **Connect to Git**
   - æˆæƒå¹¶é€‰æ‹©ä½ çš„ä»“åº“

4. **é…ç½®æ„å»ºè®¾ç½®** âš ï¸ **é‡è¦**
   ```
   Framework preset: None
   Build command: npm run build
   Build output directory: /
   Root directory: (ç•™ç©º)
   ```
   
   **æ³¨æ„äº‹é¡¹ï¼š**
   - âœ… **Build command**: `npm run build` - éªŒè¯æ–‡ä»¶å¹¶æˆåŠŸé€€å‡º
   - âœ… **Build output directory**: `/` - å¿…é¡»æ˜¯æ–œæ ï¼Œè¡¨ç¤ºæ ¹ç›®å½•
   - âŒ **ä¸è¦ä½¿ç”¨** `npm run dev`ï¼ˆè¿™ä¼šå¯¼è‡´éƒ¨ç½²å¡ä½ï¼‰
   - âŒ **ä¸è¦ä½¿ç”¨** `npx wrangler deploy`ï¼ˆè¿™æ˜¯ Workers å‘½ä»¤ï¼Œä¸é€‚ç”¨äº Pagesï¼‰
   - âŒ **ä¸è¦ä½¿ç”¨** `npx wrangler pages deploy`ï¼ˆè¿™æ˜¯ CLI å‘½ä»¤ï¼Œä¸æ˜¯ Dashboard å‘½ä»¤ï¼‰
   
   > ğŸ’¡ **é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Ÿ** è¯·æŸ¥çœ‹è¯¦ç»†çš„ [éƒ¨ç½²æŒ‡å— (DEPLOYMENT.md)](./DEPLOYMENT.md)

5. **éƒ¨ç½²**
   - ç‚¹å‡» **Save and Deploy**
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸ 1-2 åˆ†é’Ÿï¼‰

### æ–¹å¼äºŒï¼šä½¿ç”¨ Wrangler CLIï¼ˆå‘½ä»¤è¡Œéƒ¨ç½²ï¼‰

å¦‚æœä½ éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œéƒ¨ç½²ï¼ˆé€‚ç”¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒï¼‰ï¼š

```bash
# æ–¹æ³• 1ï¼šä½¿ç”¨é¡¹ç›®ä¸­çš„ npm è„šæœ¬ï¼ˆæ¨èï¼‰
npm run deploy

# æ–¹æ³• 2ï¼šç›´æ¥ä½¿ç”¨ wrangler å‘½ä»¤
# é¦–å…ˆå®‰è£… Wranglerï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
npm install -g wrangler

# ç™»å½• Cloudflare
wrangler login

# éƒ¨ç½²é¡¹ç›®ï¼ˆæ³¨æ„ï¼šä½¿ç”¨ pages deployï¼Œä¸æ˜¯ deployï¼‰
wrangler pages deploy . --project-name=air-writing
```

**é‡è¦æç¤ºï¼š**
- âœ… æœ¬åœ°å‘½ä»¤è¡Œéƒ¨ç½²ä½¿ç”¨ `wrangler pages deploy` æˆ– `npm run deploy`
- âŒ **ä¸è¦ä½¿ç”¨** `wrangler deploy`ï¼ˆè¿™æ˜¯ Workers å‘½ä»¤ï¼Œä¼šæŠ¥é”™ï¼‰
- ğŸ“ Cloudflare Pages å’Œ Cloudflare Workers æ˜¯ä¸åŒçš„äº§å“ï¼Œä½¿ç”¨ä¸åŒçš„å‘½ä»¤

### éƒ¨ç½²é…ç½®è¯´æ˜

é¡¹ç›®åŒ…å« `wrangler.toml` é…ç½®æ–‡ä»¶ï¼š

```toml
name = "air-writing"
compatibility_date = "2024-01-01"
pages_build_output_dir = "."
```

### ä¸ºä»€ä¹ˆæ˜¯çº¯é™æ€é¡¹ç›®ï¼Ÿ

- âœ… æ— éœ€ç¼–è¯‘æˆ–æ„å»º
- âœ… ES6 æ¨¡å—ç”±æµè§ˆå™¨åŸç”Ÿæ”¯æŒ
- âœ… æ‰€æœ‰æ–‡ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨
- âœ… å…¼å®¹ Cloudflare Pages çš„è¾¹ç¼˜ç½‘ç»œ

### éƒ¨ç½²å

- è·å¾— `*.pages.dev` åŸŸå
- æ¯æ¬¡ `git push` è‡ªåŠ¨é‡æ–°éƒ¨ç½²
- æ”¯æŒé¢„è§ˆéƒ¨ç½²ï¼ˆPull Requestï¼‰

### è‡ªå®šä¹‰åŸŸå

1. è¿›å…¥é¡¹ç›®è®¾ç½®
2. ç‚¹å‡» **Custom domains**
3. æ·»åŠ ä½ çš„åŸŸå
4. æŒ‰ç…§æç¤ºé…ç½® DNSï¼ˆé€šå¸¸æ˜¯æ·»åŠ  CNAME è®°å½•ï¼‰

## ğŸ”§ é…ç½®è°ƒæ•´

### è°ƒæ•´å¹³æ»‘åº¦

åœ¨ `assets/js/app.js` ä¸­ä¿®æ”¹å¹³æ»‘å› å­ï¼š

```javascript
this.smoothing = new DrawingSmoothing(0.5); // 0-1ï¼Œå€¼è¶Šå°è¶Šå¹³æ»‘
```

### è°ƒæ•´æåˆé˜ˆå€¼

åœ¨ `assets/js/config.js` ä¸­ä¿®æ”¹ï¼š

```javascript
pinchThreshold: 0.05  // è·ç¦»é˜ˆå€¼ï¼Œå€¼è¶Šå°è¶Šçµæ•
```

### æ·»åŠ æ–°è¯­è¨€

åœ¨ `assets/js/i18n.js` ä¸­æ·»åŠ æ–°çš„è¯­è¨€é…ç½®ï¼š

```javascript
translations: {
    zh: {
        newKey: 'æ–°æ–‡æœ¬'
    },
    en: {
        newKey: 'New Text'
    }
}
```

åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```javascript
import { I18N } from './i18n.js';
const text = I18N.t('newKey');
```

åœ¨HTMLä¸­ä½¿ç”¨ï¼š

```html
<span data-i18n="newKey">é»˜è®¤æ–‡æœ¬</span>
```

## ğŸ” æ•…éšœæ’é™¤

### æ‘„åƒå¤´æ— æ³•è®¿é—®

- ç¡®ä¿ä½¿ç”¨ HTTPS æˆ– localhost
- æ£€æŸ¥æµè§ˆå™¨æƒé™è®¾ç½®
- ç¡®è®¤æ²¡æœ‰å…¶ä»–åº”ç”¨å ç”¨æ‘„åƒå¤´

### æ‰‹åŠ¿è¯†åˆ«ä¸å‡†ç¡®

- è°ƒæ•´å…‰çº¿ï¼Œç¡®ä¿æ‰‹éƒ¨æ¸…æ™°å¯è§
- ä¿æŒæ‰‹éƒ¨åœ¨æ‘„åƒå¤´è§†é‡å†…
- è°ƒæ•´æ‰‹ä¸æ‘„åƒå¤´çš„è·ç¦»ï¼ˆå»ºè®®30-60cmï¼‰

### çº¿æ¡æŠ–åŠ¨

å·²å®ç°å¹³æ»‘ç®—æ³•ï¼Œå¦‚éœ€è°ƒæ•´å¹³æ»‘å› å­ï¼Œè¯·å‚è€ƒé…ç½®è°ƒæ•´éƒ¨åˆ†ã€‚

### æ¨¡å—åŠ è½½å¤±è´¥

- ç¡®ä¿æ‰€æœ‰æ–‡ä»¶è·¯å¾„æ­£ç¡®
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
- éªŒè¯æµè§ˆå™¨æ”¯æŒ ES6 æ¨¡å—

### éƒ¨ç½²å¤±è´¥

**å®Œæ•´çš„éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒï¼š[DEPLOYMENT.md](./DEPLOYMENT.md)** ğŸ“–

æ£€æŸ¥ä»¥ä¸‹å¸¸è§é—®é¢˜ï¼š

**é—®é¢˜ 1: éƒ¨ç½²åæ˜¾ç¤º "Hello World"**

**åŸå› ï¼š** Build output directory è®¾ç½®ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥ä½ çš„ Pages é¡¹ç›®
3. ç‚¹å‡» **Settings** â†’ **Builds & deployments**
4. ç‚¹å‡» **Edit configuration**
5. âš ï¸ **ç¡®ä¿ "Build command" è®¾ç½®ä¸º `npm run build`**
6. âš ï¸ **ç¡®ä¿ "Build output directory" è®¾ç½®ä¸º `/`** (æ–œæ )
7. ç‚¹å‡» **Save** å¹¶é‡æ–°éƒ¨ç½²

**é—®é¢˜ 2: ä½¿ç”¨ `npm run dev` åéƒ¨ç½²å¡ä½**

**åŸå› ï¼š** `npm run dev` å¯åŠ¨å¼€å‘æœåŠ¡å™¨ä¸ä¼šé€€å‡º

**è§£å†³æ–¹æ¡ˆï¼š**
1. ä¸è¦ä½¿ç”¨ `npm run dev` ä½œä¸ºæ„å»ºå‘½ä»¤
2. ä½¿ç”¨ `npm run build` æ›¿ä»£

**é”™è¯¯ï¼š`It looks like you've run a Workers-specific command in a Pages project`**

å¦‚æœåœ¨ Cloudflare Pages éƒ¨ç½²æ—¶çœ‹åˆ°æ­¤é”™è¯¯ï¼š

**åŸå› ï¼š** åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­ä½¿ç”¨äº†é”™è¯¯çš„éƒ¨ç½²å‘½ä»¤ï¼ˆå¦‚ `npx wrangler deploy`ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥ä½ çš„ Pages é¡¹ç›®
3. ç‚¹å‡» **Settings** â†’ **Builds & deployments**
4. ç‚¹å‡» **Edit configuration**
5. âš ï¸ **ç¡®ä¿ "Build command" è®¾ç½®ä¸º `npm run build`**
6. ç¡®ä¿ "Build output directory" è®¾ç½®ä¸º `/`
7. ç‚¹å‡» **Save** å¹¶é‡æ–°éƒ¨ç½²

**è¯´æ˜ï¼š**
- `npx wrangler deploy` æ˜¯ç”¨äº Cloudflare Workers çš„å‘½ä»¤
- `npx wrangler pages deploy` æ˜¯ç”¨äº Cloudflare Pages çš„ CLI å‘½ä»¤
- åœ¨ Cloudflare Pages Dashboard çš„ Git é›†æˆéƒ¨ç½²ä¸­ï¼Œä½¿ç”¨ `npm run build` ä½œä¸ºæ„å»ºå‘½ä»¤
- åªæœ‰åœ¨æœ¬åœ°å‘½ä»¤è¡Œæ‰‹åŠ¨éƒ¨ç½²æ—¶æ‰éœ€è¦ä½¿ç”¨ `npm run deploy` æˆ– `wrangler pages deploy`

**å…¶ä»–æ£€æŸ¥é¡¹ï¼š**
1. ç¡®ä¿ Build command è®¾ç½®ä¸º `npm run build`
2. Build output directory è®¾ç½®ä¸º `/`
3. Framework preset è®¾ç½®ä¸º None

## ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§

- âœ… Chrome 90+
- âœ… Edge 90+
- âœ… Firefox 88+
- âœ… Safari 14+

**è¦æ±‚**:
- æ”¯æŒ ES6 æ¨¡å—
- æ”¯æŒ WebRTCï¼ˆæ‘„åƒå¤´è®¿é—®ï¼‰
- æ”¯æŒ Canvas API

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

1. **ä¿æŒæ‰‹éƒ¨ç¨³å®š** - ç§»åŠ¨é€Ÿåº¦é€‚ä¸­ï¼Œé¿å…è¿‡å¿«
2. **å…‰çº¿å……è¶³** - ç¡®ä¿æ‰‹éƒ¨æ¸…æ™°å¯è§
3. **é€‚å½“è·ç¦»** - ä¿æŒæ‰‹éƒ¨åœ¨æ‘„åƒå¤´è§†é‡ä¸­å¤®
4. **ç»ƒä¹ æåˆ** - ç†Ÿæ‚‰æåˆæ‰‹åŠ¿çš„åŠ›åº¦å’Œè·ç¦»

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **JavaScript æ¨¡å—**: 8 ä¸ª
- **CSS æ–‡ä»¶**: 1 ä¸ª
- **HTML æ–‡ä»¶**: 1 ä¸ª
- **æ€»ä»£ç è¡Œæ•°**: ~1800+ è¡Œ
- **æ”¯æŒè¯­è¨€**: 2 ç§ï¼ˆä¸­æ–‡ã€è‹±æ–‡ï¼‰

## ğŸ¯ é¡¹ç›®äº®ç‚¹

- âœ… å®Œæ•´çš„åŒè¯­æ”¯æŒï¼ˆä¸­è‹±æ–‡ï¼‰
- âœ… æ¨¡å—åŒ–çš„å›½é™…åŒ–ç³»ç»Ÿ
- âœ… å¹³æ»‘çš„ç»˜å›¾ä½“éªŒï¼ˆEMA + è´å¡å°”æ›²çº¿ï¼‰
- âœ… ç°ä»£åŒ–çš„ UI è®¾è®¡ï¼ˆç»ç’ƒæ€ï¼‰
- âœ… å®Œå–„çš„æ–‡æ¡£
- âœ… ä¸€é”®éƒ¨ç½²åˆ° Cloudflare Pages

## ğŸ“ è®¸å¯è¯

MIT License

---

<a name="english"></a>

## ğŸ“– Project Introduction

A gesture-based air writing web application that uses MediaPipe Hands technology for real-time hand tracking and drawing. Users can capture hand movements through a camera to write and draw in the air.

## âœ¨ Features

- ğŸ–ï¸ **Real-time Gesture Recognition** - Precise hand tracking using MediaPipe Hands
- âœï¸ **Air Writing** - Write and draw in the air with pinch gestures
- ğŸ¨ **Customizable Brush** - Multiple colors and adjustable brush sizes
- âœ¨ **Smooth Drawing** - Eliminates jitter using BÃ©zier curves and exponential moving average
- ğŸ’¾ **Save Artwork** - One-click save your creations as PNG images
- ğŸŒ **Static Deployment** - Pure frontend implementation, perfectly compatible with Cloudflare Pages
- ğŸŒ **Bilingual Support** - Switch between Chinese and English interfaces
- ğŸ“± **Responsive Design** - Adapts to various screen sizes
- ğŸ­ **Modern UI** - Glassmorphism design with smooth animations
- ğŸ—ï¸ **Modular Architecture** - Clear code structure, easy to maintain and extend

## ğŸš€ Quick Start

### Step 1: Clone the Project

```bash
git clone <your-repo-url>
cd air-writing
```

### Step 2: Install Dependencies

```bash
npm install
```

### Step 3: Start Local Server

```bash
npm run dev
```

The browser will automatically open `http://localhost:8000`

### Step 4: Grant Camera Permission

On first visit, the browser will request camera permission, click "Allow".

### Step 5: Start Writing

1. Extend your hand in front of the camera
2. Bring index finger and thumb close together (pinch) to start drawing
3. Move your finger to write
4. Separate fingers to stop drawing

## ğŸ® Usage

### Gesture Controls

- **Start Drawing** - Bring index finger and thumb close together (pinch gesture)
- **Stop Drawing** - Separate fingers
- **Move Cursor** - Move index finger to control drawing position

### Brush Settings

- Adjust brush size slider to change line thickness
- Click color buttons to select different brush colors
- Use "Clear Canvas" button to clear all content
- Use "Save Image" button to download your artwork

### Language Switching

Click the language toggle button in the top right corner to switch between Chinese and English.

## ğŸ“ Project Structure

```
air-writing/
â”œâ”€â”€ assets/                 # Assets directory
â”‚   â”œâ”€â”€ css/               # Style files
â”‚   â”‚   â””â”€â”€ style.css      # Main stylesheet
â”‚   â”œâ”€â”€ js/                # JavaScript modules
â”‚   â”‚   â”œâ”€â”€ app.js         # Main application entry
â”‚   â”‚   â”œâ”€â”€ config.js      # Configuration management
â”‚   â”‚   â”œâ”€â”€ i18n.js        # Internationalization support
â”‚   â”‚   â”œâ”€â”€ canvas-renderer.js    # Canvas renderer
â”‚   â”‚   â”œâ”€â”€ gesture-detector.js   # Gesture detector
â”‚   â”‚   â”œâ”€â”€ mediapipe-manager.js  # MediaPipe manager
â”‚   â”‚   â”œâ”€â”€ ui-controller.js      # UI controller
â”‚   â”‚   â””â”€â”€ drawing-smoothing.js  # Drawing smoothing
â”‚   â””â”€â”€ images/            # Image assets
â”œâ”€â”€ index.html             # Main HTML file
â”œâ”€â”€ package.json           # NPM configuration
â”œâ”€â”€ wrangler.toml          # Cloudflare configuration
â”œâ”€â”€ .gitignore             # Git ignore file
â””â”€â”€ README.md              # Project documentation
```

## ğŸ—ï¸ Modular Architecture

The project adopts a modular design with clear responsibilities for each module:

### Core Modules

- **config.js** - Centralized configuration management
- **i18n.js** - Internationalization and language switching
- **canvas-renderer.js** - All Canvas drawing operations
- **gesture-detector.js** - Gesture recognition and detection logic
- **mediapipe-manager.js** - MediaPipe engine management
- **ui-controller.js** - User interface interaction control
- **drawing-smoothing.js** - Drawing smoothing algorithms
- **app.js** - Main application integrating all modules

## ğŸ› ï¸ Tech Stack

- **HTML5** - Page structure
- **CSS3** - Styling and animations
- **JavaScript (ES6+)** - Application logic
- **MediaPipe Hands** - Gesture recognition
- **Canvas API** - Drawing functionality
- **Cloudflare Pages** - Edge deployment

## ğŸŒŸ Core Implementation

### Gesture Recognition

Uses MediaPipe Hands library for real-time hand landmark detection, determining pinch gestures by calculating the distance between thumb and index finger tips.

```javascript
const distance = Math.sqrt(
    Math.pow(thumbTip.x - indexTip.x, 2) +
    Math.pow(thumbTip.y - indexTip.y, 2) +
    Math.pow(thumbTip.z - indexTip.z, 2)
);
return distance < pinchThreshold;
```

### Smooth Drawing System

To eliminate jitter from hand tremors, a dual smoothing mechanism is implemented:

1. **Exponential Moving Average (EMA)** - Time series smoothing of hand positions
2. **BÃ©zier Curve Interpolation** - Quadratic BÃ©zier curves for smoother line connections

```javascript
// Exponential Moving Average
const weight = Math.pow(smoothingFactor, points.length - 1 - i);
smoothedX += points[i].x * weight;

// BÃ©zier Curve Interpolation
const cpx = (x1 + x2) / 2;
const cpy = (y1 + y2) / 2;
ctx.quadraticCurveTo(x1, y1, cpx, cpy);
```

These two techniques combined significantly enhance the writing experience.

### Internationalization Support

Complete Chinese-English bilingual support:

- Dynamic language switching
- Local storage of language preferences
- All UI text supports translation
- Smooth transition animations

## â˜ï¸ Cloudflare Pages Deployment

This project is a pure static website that supports automatic deployment to Cloudflare Pages via Git integration.

### Method 1: Git Integration (Recommended - Auto Deploy)

1. **Push code to Git repository**
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

2. **Log in to Cloudflare Dashboard**
   - Visit https://dash.cloudflare.com/
   - Go to **Pages** section

3. **Create new project**
   - Click **Create a project**
   - Select **Connect to Git**
   - Authorize and select your repository

4. **Configure build settings** âš ï¸ **IMPORTANT**
   ```
   Framework preset: None
   Build command: npm run build
   Build output directory: /
   Root directory: (leave empty)
   ```
   
   **Important Notes:**
   - âœ… **Build command**: `npm run build` - Validates files and exits successfully
   - âœ… **Build output directory**: `/` - Must be forward slash, indicating root directory
   - âŒ **DO NOT use** `npm run dev` (this causes deployment to hang)
   - âŒ **DO NOT use** `npx wrangler deploy` (this is a Workers command, not for Pages)
   - âŒ **DO NOT use** `npx wrangler pages deploy` (this is a CLI command, not for Dashboard)
   
   > ğŸ’¡ **Having deployment issues?** See detailed [Deployment Guide (DEPLOYMENT.md)](./DEPLOYMENT.md)

5. **Deploy**
   - Click **Save and Deploy**
   - Wait for deployment to complete (usually 1-2 minutes)

### Method 2: Using Wrangler CLI (Command Line Deployment)

If you need to deploy via command line (for local development environment):

```bash
# Method 1: Use the npm script in the project (Recommended)
npm run deploy

# Method 2: Use wrangler command directly
# First install Wrangler (if not already installed)
npm install -g wrangler

# Login to Cloudflare
wrangler login

# Deploy project (Note: use pages deploy, not deploy)
wrangler pages deploy . --project-name=air-writing
```

**Important Notes:**
- âœ… For local CLI deployment, use `wrangler pages deploy` or `npm run deploy`
- âŒ **DO NOT use** `wrangler deploy` (this is a Workers command and will error)
- ğŸ“ Cloudflare Pages and Cloudflare Workers are different products with different commands

### Deployment Configuration

The project includes a `wrangler.toml` configuration file:

```toml
name = "air-writing"
compatibility_date = "2024-01-01"
pages_build_output_dir = "."
```

### Why Pure Static?

- âœ… No compilation or build needed
- âœ… ES6 modules natively supported by browsers
- âœ… All files can be used directly
- âœ… Compatible with Cloudflare Pages edge network

### After Deployment

- Get a `*.pages.dev` domain
- Auto redeploy on every `git push`
- Support preview deployments (Pull Requests)

### Custom Domain

1. Go to project settings
2. Click **Custom domains**
3. Add your domain
4. Follow prompts to configure DNS (usually add CNAME record)

## ğŸ”§ Configuration

### Adjust Smoothness

Modify smoothing factor in `assets/js/app.js`:

```javascript
this.smoothing = new DrawingSmoothing(0.5); // 0-1, smaller = smoother
```

### Adjust Pinch Threshold

Modify in `assets/js/config.js`:

```javascript
pinchThreshold: 0.05  // Distance threshold, smaller = more sensitive
```

### Add New Language

Add new language configuration in `assets/js/i18n.js`:

```javascript
translations: {
    zh: {
        newKey: 'æ–°æ–‡æœ¬'
    },
    en: {
        newKey: 'New Text'
    }
}
```

Use in code:

```javascript
import { I18N } from './i18n.js';
const text = I18N.t('newKey');
```

Use in HTML:

```html
<span data-i18n="newKey">Default Text</span>
```

## ğŸ” Troubleshooting

### Camera Access Issues

- Ensure using HTTPS or localhost
- Check browser permission settings
- Confirm no other app is using the camera

### Inaccurate Gesture Recognition

- Adjust lighting to ensure hand is clearly visible
- Keep hand within camera view
- Adjust hand-to-camera distance (recommended 30-60cm)

### Line Jitter

Smoothing algorithm is implemented. To adjust, see Configuration section.

### Module Loading Failure

- Ensure all file paths are correct
- Check browser console for errors
- Verify browser supports ES6 modules

### Deployment Failure

**For complete deployment guide, see: [DEPLOYMENT.md](./DEPLOYMENT.md)** ğŸ“–

Check these common issues:

**Issue 1: "Hello World" appears after deployment**

**Cause:** Incorrect Build output directory setting

**Solution:**
1. Log in to Cloudflare Dashboard
2. Go to your Pages project
3. Click **Settings** â†’ **Builds & deployments**
4. Click **Edit configuration**
5. âš ï¸ **Ensure "Build command" is set to `npm run build`**
6. âš ï¸ **Ensure "Build output directory" is set to `/`** (forward slash)
7. Click **Save** and redeploy

**Issue 2: Deployment hangs when using `npm run dev`**

**Cause:** `npm run dev` starts a dev server that never exits

**Solution:**
1. Don't use `npm run dev` as build command
2. Use `npm run build` instead

**Error: `It looks like you've run a Workers-specific command in a Pages project`**

If you see this error when deploying to Cloudflare Pages:

**Cause:** Used incorrect deploy command in Cloudflare Pages project settings (like `npx wrangler deploy`)

**Solution:**
1. Log in to Cloudflare Dashboard
2. Go to your Pages project
3. Click **Settings** â†’ **Builds & deployments**
4. Click **Edit configuration**
5. âš ï¸ **Ensure "Build command" is set to `npm run build`**
6. Ensure "Build output directory" is set to `/`
7. Click **Save** and redeploy

**Explanation:**
- `npx wrangler deploy` is the command for Cloudflare Workers
- `npx wrangler pages deploy` is the command for Cloudflare Pages CLI
- In Cloudflare Pages Dashboard Git integration deployment, use `npm run build` as build command
- Only use `npm run deploy` or `wrangler pages deploy` when manually deploying from local command line

**Other checks:**
1. Ensure Build command is set to `npm run build`
2. Build output directory set to `/`

## ğŸŒ Browser Compatibility

- âœ… Chrome 90+
- âœ… Edge 90+
- âœ… Firefox 88+
- âœ… Safari 14+

**Requirements**:
- ES6 module support
- WebRTC support (camera access)
- Canvas API support

## ğŸ’¡ Tips

1. **Keep Hand Steady** - Move at moderate speed, avoid too fast
2. **Adequate Lighting** - Ensure hand is clearly visible
3. **Proper Distance** - Keep hand in center of camera view
4. **Practice Pinching** - Get familiar with pinch gesture strength and distance

## ğŸ“Š Project Statistics

- **JavaScript Modules**: 8
- **CSS Files**: 1
- **HTML Files**: 1
- **Total Lines of Code**: ~1800+
- **Supported Languages**: 2 (Chinese, English)

## ğŸ¯ Project Highlights

- âœ… Complete bilingual support (Chinese & English)
- âœ… Modular internationalization system
- âœ… Smooth drawing experience (EMA + BÃ©zier curves)
- âœ… Modern UI design (Glassmorphism)
- âœ… Comprehensive documentation
- âœ… One-click deployment to Cloudflare Pages

## ğŸ“ License

MIT License

---

## ğŸ”— Links / é“¾æ¥

- **GitHub**: https://github.com/longzheng268/air-writing
- **Gitee**: https://gitee.com/longzheng0315/air-writing

---

**é¡¹ç›®å®Œæˆæ—¶é—´ / Project Completion**: 2025-12-07  
**ç‰ˆæœ¬ / Version**: 1.0.0  
**çŠ¶æ€ / Status**: âœ… ç”Ÿäº§å°±ç»ª / Production Ready
